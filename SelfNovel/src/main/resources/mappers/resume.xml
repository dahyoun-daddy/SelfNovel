<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.sn.resume.repository.mappers.resume">
	
	<!-- Insert -->
	<insert id="do_save" parameterType="com.sn.resume.domain.RsmVO">
		INSERT INTO RESUME (
		    RSM_ID,
		    IMG_ID,
		    RSM_TITLE,
		    RSM_CONTENT,
		    U_ID,
		    RSM_REG_DT,
		    RSM_COUNT,
		    RSM_RECOMMEND,
		    RSM_USE_YN,
		    RSM_ORD_YN
		) VALUES (
		    #{rsm_id,        jdbcType=NUMBER(8)}         ,
		    #{img_id,        jdbcType=NUMBER }           ,
		    #{rsm_title,     jdbcType=VARCHAR2(50 CHAR)} ,
		    #{rsm_content,   jdbcType=CLOB }             ,
		    #{u_id,          jdbcType=VARCHAR2(100 Byte)},
		    SYSDATE                                      ,
		    #{rsm_count,     jdbcType=NUMBER(5,0)}       ,
		    #{rsm_recommend, jdbcType=NUMBER(5,0)}       ,
		    #{rsm_use_yn,    jdbcType=NUMBER(1,0)}       ,
		    #{rsm_ord_yn,    jdbcType=NUMBER(1,0)}       
		)	
	</insert>	
	
	<!-- Delete -->
	<delete id="do_delete" parameterType="com.sn.resume.domain.RsmVO">
		DELETE FROM RESUME 
		WHERE RSM_ID = #{rsm_id, jdbcType=NUMBER(8)}
	</delete>
	
	<!-- Update -->
	<update id="do_update" parameterType="com.sn.resume.domain.RsmVO">		
		UPDATE RESUME 
		SET IMG_ID        = #{img_id,        jdbcType=NUMBER }           ,
		    RSM_TITLE     = #{rsm_title,     jdbcType=VARCHAR2(50 CHAR)} ,
		    RSM_CONTENT   = #{rsm_content,   jdbcType=CLOB }             ,
		    U_ID          = #{u_id,          jdbcType=VARCHAR2(100 Byte)},
		    RSM_COUNT     = #{rsm_count,     jdbcType=NUMBER(5,0)}       ,
		    RSM_RECOMMEND = #{rsm_recommend, jdbcType=NUMBER(5,0)}       ,
		    RSM_USE_YN    = #{rsm_use_yn,    jdbcType=NUMBER(1,0)}       ,
		    RSM_ORD_YN    = #{rsm_ord_yn,    jdbcType=NUMBER(1,0)}
		WHERE RSM_ID =:ID;
	</update>
	
	<!-- SearchOne -->
	<select id="do_searchOne" parameterType="com.sn.resume.domain.RsmVO"
							  resultType="com.sn.resume.domain.RsmVO">
		SELECT
		    RSM_ID,
		    IMG_ID,
		    RSM_TITLE,
		    RSM_CONTENT,
		    U_ID,
		    RSM_REG_DT,
		    RSM_COUNT,
		    RSM_RECOMMEND,
		    RSM_COUNT,
		    RSM_USE_YN,
		    RSM_ORD_YN
		FROM RESUME
		WHERE ID=#{rsm_id, jdbcType=NUMBER(8)}      
	</select>
	
	<!-- TODO : 전체조회(do_search) -->
	<select id="do_search" parameterType="com.sn.resume.domain.RsmVO"
						   resultType="com.sn.resume.domain.RsmVO">
		SELECT T1.*
       , TO_CHAR(T1.reg_dt,'YYYY-MM-DD') AS REG_DT
       , T1.TOTAL_CNT
       , T1.RNUM
		  FROM(                                                     
				SELECT A.*                                                
					   , ROW_NUMBER() OVER(ORDER BY A.RSM_REG_DT DESC) as RNUM 
					   , COUNT(*) OVER () AS TOTAL_CNT                     
				  FROM RESUME A	
		          ORDER BY A.RSM_REG_DT DESC
			  ) T1   			  
		WHERE RNUM BETWEEN (#{PAGE_SIZE} * (#{PAGE_NUM}-1)+1) AND (#{PAGE_SIZE} * (#{PAGE_NUM}-1)+#{PAGE_SIZE})
	</select>
</mapper>  
  
  
  